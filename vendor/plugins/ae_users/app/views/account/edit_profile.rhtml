<h1>Edit profile</h1>

<% form_tag ({:action => 'change_password'}, {:class => 'cmxform'}) do |f| %>
  <fieldset>
    <legend>Change password</legend>
    
    <ol>
      <li>
        <label for="password1">New password:</label>
        <%= password_field_tag "password1" %>
      </li>
      <li>
        <label for="password2">Confirm new password:</label>
        <%= password_field_tag "password2" %>
      </li>
    </ol>
  </fieldset>
  <%= submit_tag "Change password" %>
<% end %>

<p></p>

<% form_tag ({:action => 'edit_email_addresses'}, {:class => 'cmxform'}) do |f| %>
  <fieldset>
    <legend>Edit email addresses</legend>
    
    <p>Note: every account must have one "primary" email address.  This is the one the site will use
      to send you email (for example, if you forget your password).</p>
    
    <table>
      <tr>
        <th></th>
        <th>Address</th>
        <th>Primary</th>
        <th>Delete</th>
      </tr>
      <% @person.account.email_addresses.each do |addr| -%>
        <tr>
          <td></td>
          <td>
            <i><%= addr.address %></i>
          </td>
          <td>
            <%= radio_button_tag "primary", addr.id, addr.primary %>
          </td>
          <td>
            <%= check_box_tag "delete", addr.id %>
          </td>
        </tr>
      <% end -%>
      <tr>
        <td>Add new address:</td>
        <td>
          <%= text_field_tag "new_address" %>
        </td>
        <td>
          <%= radio_button_tag "primary", "new" %>
        </td>
      </tr>
    </table>
  </fieldset>
  <%= submit_tag "Edit email addresses" %>
<% end %>

<p></p>

<% form_tag ({:action => 'edit_profile'}, {:class => 'cmxform'}) do |f| %>
  <%= render :partial => 'personal_info' %>
  <%= submit_tag "Save personal information" %>
<% end %>