<div id="responses">
<% if @count == 0 %>
<p>No responses found.</p>
<% else %>
    <% header_fields = @questionnaire.special_field_associations.select { |sfa| sfa.purpose != 'name' }%>
    <table id="responsetable" style="width: 100%; border-collapse: collapse;">
        <tr>
          <th></th>
          <% @columns.each do |column| -%>
            <th>
              <% if column.kind_of? Question -%>
                <%= column.caption %>
              <% elsif column.kind_of? String -%>
                <%= column.humanize %>
              <% end -%>
            </th>
          <% end -%>
        </tr>
        <% @responses.each do |response| %>
            <tr class="<%=cycle "even", "odd" %>" style="height: 0">
              <td><%=link_to "V", response_path(@questionnaire, response), :class => "viewresponse" %></td>
              <% @columns.each do |column| -%>
                <td>
                  <% if column.kind_of? Question -%>
		    <% if ans = response.answer_for_question(column) -%>
		      <%= ans.output_value %>
		    <% end -%>
                  <% elsif column == "submitted_at" -%>
                    <% if response.submitted -%>
                      <%= response.submitted_at %>
                    <% else -%>
                      <b>Partial</b>
                    <% end -%>
                  <% elsif column -%>
                    <%= response.send(column) %>
                  <% end -%>
                </td>
              <% end -%>
            </tr>
        <% end %>
				<% (Response.per_page - @responses.length).times do %>
            <tr>
                <td>&nbsp;</td>
            </tr>
        <% end%>
    </table>
    <%= will_paginate @responses %>
<% end %>
  </div>
